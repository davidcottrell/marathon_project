\documentclass[12pt,titlepage]{article}

% \usepackages21{fancyhdr}

\usepackage[printwatermark]{xwatermark}

\usepackage{grffile}
\usepackage{xcolor}
\usepackage{lipsum}
\usepackage{times}
\usepackage{soul}
\usepackage{epsfig}
\usepackage{rotating}
\usepackage{url}
\usepackage{latexsym}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{fullpage}
\usepackage{setspace}
\usepackage{natbib}
\usepackage{longtable}
\usepackage{keyval}
\usepackage{caption,subcaption}
\usepackage{arydshln}
%%\usepackage[hyphenbreaks]{breakurl}

%% allow urls to get broken on hyphens
\usepackage{hyperref}
\def\UrlBreaks{\do\/\do-}


%% APSR submission: no commas in citations between name and year
%% See http://merkel.zoneo.net/Latex/natbib.php
\bibpunct{(}{)}{;}{author-year}{}{;}

% the opening bracket symbol, default = (
% the closing bracket symbol, default = )
% the punctuation between multiple citations, default = ;
% the letter `n' for numerical style, or `s' for numerical superscript style, any other letter for author-year, default = author-year;
% the punctuation that comes between the author names and the year
% the punctuation that comes between years or numbers when common author lists are suppressed (default = ,);

\usepackage{footmisc}
\renewcommand{\footnotelayout}{\doublespacing} % set spacing in footnotes
\newlength{\myfootnotesep}
\setlength{\myfootnotesep}{\baselineskip}
\addtolength{\myfootnotesep}{-\footnotesep}
\setlength{\footnotesep}{\myfootnotesep} % set spacing between footnotes

% make footnote font size same as regular font size in text
\renewcommand{\footnotesize}{\normalsize} 


%% Use this for a "DRAFT" watermark
%% \newwatermark[allpages,color=pink!50,angle=45,scale=5,xpos=-25,ypos=40]{DRAFT}

%% List all locations for graphics here
\graphicspath{ {../plots/} }


\begin{document}
\sloppy
\thispagestyle{empty}

%% APSR submission requires double-spaced footnotes
%%\newcommand{\footnote}[1]{\footnote{\doublespacing #1}} %% <-- note \doublespacing here.

\renewcommand{\topfraction}{.85}
\renewcommand{\bottomfraction}{.7}
\renewcommand{\textfraction}{.15}
\renewcommand{\floatpagefraction}{.66}
\renewcommand{\dbltopfraction}{.66}
\renewcommand{\dblfloatpagefraction}{.66}

\newcommand{\Yi}{\ensuremath{Y_i}}

% \urldef\myurlncsl1\url{foo%.com}
% \begin{document}
% text\footnote{WWW: \myurl}


\title{\Large{All in the family:\\German twin finishing times in\\the
    2016 women's Olympic marathon}}\author{David
  Cottrell\thanks{Postdoctoral Research Fellow, Program in
    Quantitative Social Science, Dartmouth College, 6108 Silsby Hall,
    Hanover, NH 03755 (\texttt{david.cottrell@dartmouth.edu}).} \and
  Michael C.\ Herron\thanks{Visiting Scholar, Hertie School of
    Governance, Berlin, Germany, and Professor of Government,
    Dartmouth College, 6108 Silsby Hall, Hanover, NH 03755
    (\texttt{michael.c.herron@dartmouth.edu}).}}


\maketitle \doublespacing 

%\begin{abstract} 
% \noindent
%The abstract
%\end{abstract}

%\newpage


\begin{quote}
  \emph{``I invested all I had and 300 meters before the finish line,
    I was next to Lisa. It was a magical moment that we could finish
    this marathon together. We did not think about what we were
    doing.'' -- Anna Hahner}
\end{quote}


\section*{Introduction}

At 9:30am on August 14, 2016, the women's Olympic marathon kicked off
in Rio de Janeiro, Brazil, when 156 runners from 80 countries across
the world left the starting line en route to their destination 42.195
kilometers away. Two hours, twenty-four minutes, and four seconds
later, Jemima Sumgong of Kenya would be the first to cross the
finishline and take home gold; Sumgong was just three and one-half
minutes slower than her prior personal best time in the
marathon. Approximately 21 minutes later, twin marathoners from
Germany, Anna and Lisa Hahner, would cross the finishline together,
holding hands and celebrating a personal victory. Although the Hahners
would finish 81st and 82nd, respectively, well behind the winners of
the marathon, Anna Hahner would describe their joint finish as a
``magical moment.''


%% Honigkuchenpferde reference
%%
%% https://www.welt.de/sport/olympia/article157669264/Das-falsche-Laecheln-der-deutschen-Lauf-Zwillinge.html 

The media quickly picked up the Hanher story as an image of the
beaming twins, finishing hand-in-hand, captured a public
audience. While many believed the twin's near-simultaneous finish was
a reflection of Olympic spirit, not everyone agreed with this rosy
interpretation. The twins' happy facial expressions at the finish were
portrayed as a bit contrived---smiling like ``Honigkuchenpferde,''
cookies in the shape of a horse, was the description offered by one
editorialist---and the sports director of the German Athletics
Federation, Thomas Kurschilgen, stirred up controversy when he
suggested that the Hahners' photo-finish was no coincidence.
Kurschilgen averred that the twins slowed down so as to finish
simultaneously and create a spectacle which would ``generate media
attention.''  Kurschilgen justified his charge with the fact that the
twins ran the Rio marathon over 18 minutes slower their personal best
times prior to the Olympics.  Kurschilgen's accusations were denied by
the Hahner twins, perhaps not surprisingly, who claimed that their
joint finish was simply a fortuitous coincidence.

%% Honigkuchenpferd quote from here:
%%
%% https://www.welt.de/sport/olympia/article157669264/Das-falsche-Laecheln-der-deutschen-Lauf-Zwillinge.html

What happened in the women's Olympic marathon in Rio, and how might we
develop a statistical approach that assesses whether the Hahner twin's
finish in the race was coincidental or intentional?  These two
interpretations are clearly at odds. If the former, then the Hahners
are to be celebrated and their finish treated as an expression of the
spirit behind the Olympic games. If the latter, though, then the twins
may have violated this spirt by not trying hard enough. It is perhaps
too easy for us to write such a glib sentence---neither of us can
fathom being able to complete a marathon anywhere in the vicinity of
two and a half hours---but we nonetheless want to know what the data
from the Olympic marathon tell us.

%% Was the Hahner finish in the 2016 women's Olympic marathon a lovely coincidence or something else?

Among female Olympic marathoners, the Hahner twins were not alone in
sharing familial ties.  The Rio marathon also featured twins from
North Korea, Kim Hye-song and Kim Hye-gyong, who posted identical
times and finished 10th and 11th in the race, respectively. The Kim
finish, unlike the Hahner finish, appears devoid of post-race
controversy. Moreover, three triplets from Estonia competed in the Rio
marathon, although only two, Lily Luik and Leila Luik, finished it, in
97th and 114th place, respectively. The third Estonia triplet, Liina
Luik, recorded what is known as a DNF---an abbreviation that means did
not finish.  Although our focus here is the Hahner twins, we touch on
the Kim twins and Luik triplets in the course of what follows.

\section*{Marathon data and our research design}

For each participant who started the women's Olympic marathon, we know
several things: personal best marathon time prior to the 2016 Olympic
games; split times from the Rio marathon course at 5 kilometers, 10
kilometers, and so forth; and, finishing time. We cannot directly
observe the effort that an individual put into the race, and we do not
know why some runners have DNF results.  Some runners may have injured
themselves on the course and accordingly dropped out, and others may
have dropped out, uninjured, in anticipation of an unsatisfactory
result. Of the 156 marathon starters, 133 completed the race and 23
DNFed at various locations throughout the course. The overall DNF rate
was thus $\frac{23}{156} \approx 0.15$, and the relatively small
sample size at our disposal means that a 95\% confidence for this rate
is fairly wide, namely, $\left(0.098, 0.22\right)$. 

Kurschilgen's accusation against the Hahner twins has two components,
that these two women ran slowly \emph{and} that they finished
simultaneously.  We suspect that Kurschilgen would not have expressed
ire at the Hahners had they finished in 1st and 2nd place in Rio,
hand-in-hand with wide grins.  Thus, our investigation of the charges
that Kurschilgen offered will distinguish between a slow finish versus
a simultaneous finish.

Our research design is twofold.  First, we present visualizations that
describe various features of the 2016 women's Olympic marathon, and an
important element in our visualizations is the difference between
runners' Rio times and their prior personal best marathon times.  Our
visualizations suggest that the Hahner twin's pace in the marathon was
slow, albeit not excessively so, but that their simultaneous finish
was quite unusual given the twins' differences in abilities (and
similarly for the Kim twins).  We then turn to a regression-based
simulation of the marathon, and our simulations reinforce what we
observed in prior visualizations, namely, that the Hahner twins did
not run appreciably slowly yet finished suspiciously close to each
other.  We return in our conclusion to Kurschilgen's claims about the
Hahners and offer thoughts about their validity.

\section*{Visualizing the Olympic marathon}

One way that we might assess whether an athlete's Rio finish was
unusual---or, say, whether two athletes' finishes were jointly
unusual---is by comparing a runner's observed Olympic women's marathon
finishing time on August 14, 2016, with a measure of her underlying
marathon talent.  For the latter we use prior personal best marathon
times.  This is a natural measure of marathon talent, we believe, but
it is not entirely free of complications.  For example, personal best
times are potentially confounded by the marathon courses on which they
were set; some courses, like the Berlin marathon, are known for
relatively fast times.  In addition, personal best times may be
confounded by conditions, like weather, that varied across races.
Finally, personal best times may not capture Olympic raceday
idiosyncrasies that could affect individual runners.  For example, a
runner could have woken up with a minor cold on the morning of August
14, 2016.  With these concerns in mind, we use a runner's half
marathon split time from the Olympic marathon as a secondary measure
of athletic skill in marathoning.  Our two measures of marathon talent
are featured in the visualizations below.

Figure \ref{fig:scatter} contains two plots, both of which describe
how finishing times from the Rio women's marathon varied as a function
of athletes' personal best times and half marathon split times.  The
points in the plots are colored by twin/triplet status, and both plots
contain second-order polynomial regression lines.  The ticks along the
horizontal axes in both plots indicate times, either personal bests or
half marathon splits, of runners who earned DNF results.

\begin{figure}[!ht]
  \centering
  \caption{Olympic finishing times as a function of underlying marathon talent}
  \label{fig:scatter}
  \begin{subfigure}{.495\textwidth}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio]{scatter_plot.pdf}
    \caption{Based on personal best} 
    \label{fig:45degreeplot}
  \end{subfigure}
  \begin{subfigure}{.495\textwidth}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio]{scatter_plot_half.pdf}
    \caption{Based on half marathon split} 
    \label{fig:45degreeplot_half}
  \end{subfigure}
\end{figure}

Considering first the relationship between Olympic finishing and
personal best times, Figure \ref{fig:45degreeplot}'s solid 45-degree
line is informative.  Given the paucity of points (only five of them)
below this line, it follows that the vast majority of Olympic
marathoners ran slower in Rio compared to their prior personal bests.
The Hahner twins were definitely on the slow side, well above the 45-degree line,
but a number of runners had even greater differences between
their Olympic times and their personal bests than the Hahners.  These
runners are denoted with squares in Figure \ref{fig:45degreeplot}, and
there are 13 such symbols, highlighting approximately 10\% of the
racers who completed the Rio marathon.  Moreover, the figure shows
that there were two women who had personal best times slightly faster
than the Hahner's and yet finished after the German women.  Although
Figure \ref{fig:45degreeplot} suggests that the Hahner twins were
slower than one would have expected given their previous best marathon
times, it is not consistent with the accusation that they dramatically
slowed down in the Rio marathon.

% > df <- read.csv("data/times.csv", stringsAsFactors = FALSE) %>% tbl_df()
% > df <- df[df$BIB != 1172,]
% > sort(dta$FINAL - dta$PB) / 60
%   [1] -2.3333333 -2.2166667 -2.0666667 -1.1166667 -0.4000000  0.2166667
%   [7]  0.6333333  0.9000000  1.0166667  1.3666667  1.5166667  1.7166667
%  [13]  1.7666667  1.8500000  2.1166667  2.4666667  2.5333333  3.0166667
%  [19]  3.0500000  3.1666667  3.2666667  3.2833333  3.3666667  3.4500000
%  [25]  3.6833333  3.9000000  3.9833333  4.2000000  4.2666667  4.3833333
%  [31]  4.4666667  4.5833333  4.6166667  4.6333333  4.6833333  4.7333333
%  [37]  4.7333333  4.8333333  5.0666667  5.0833333  5.0833333  5.1000000
%  [43]  5.1333333  5.3500000  5.3500000  5.4000000  5.7166667  5.7333333
%  [49]  5.9333333  6.0000000  6.0333333  6.1166667  6.3333333  6.3500000
%  [55]  6.5000000  6.5333333  6.6000000  6.6666667  6.7166667  6.7833333
%  [61]  6.8166667  6.9500000  7.1000000  7.1500000  7.2000000  7.3500000
%  [67]  7.4500000  7.5666667  7.6000000  7.6000000  7.6333333  7.7500000
%  [73]  7.8833333  7.9666667  7.9833333  8.3000000  8.6000000  9.3000000
%  [79]  9.5500000  9.5833333  9.6000000  9.7166667  9.9500000  9.9833333
%  [85] 10.3166667 10.5333333 10.6666667 10.7000000 10.8333333 10.9666667
%  [91] 11.1500000 11.1833333 11.4666667 11.7166667 12.1666667 12.6000000
%  [97] 12.9166667 13.2166667 13.2833333 13.3833333 13.7666667 13.8666667
% [103] 13.9166667 14.0500000 14.0833333 14.5666667 14.6833333 14.7500000
% [109] 15.0000000 15.0500000 15.5000000 15.9000000 16.2000000 16.9000000
% [115] 17.4500000 18.1000000 18.6666667 18.7166667 18.8000000 18.9333333
% [121] 20.1500000 20.6333333 20.7000000 20.8500000 21.3500000 23.4166667
% [127] 24.9333333 25.6500000 26.5666667 26.7666667 29.2166667 30.7000000
% [133] 30.9666667
% > 

With respect to our second measure of marathon skill, Figure
\ref{fig:45degreeplot_half} shows that there was nothing abnormal
about the Hahner twins' overall finishing times, conditional on their
half marathon splits. As one might expect, a runner's time halfway
through the course is a fairly strong predictor of her finishing time.
Here we see that the relationship between the Hehner twin's half
marathon split times and their finishing times is similar to that of
other Rio runners.  The two points representing the Hahners are in the
middle of the distribution of points and therefore imply that the
twins do not seem to have slowed down in any unusual way.  This is
consistent with the previous Figure \ref{fig:45degreeplot} and
inconsistent with accusations made against the Hahner twins, at least
the part of the accusation that focused on their overall pace.

Another perspective on the extent to which the Hahners' overall
marathon finishing times were not unusual can be gleaned from Figure
\ref{fig:residuals}.  This figure presents cumulative distributions of
the polynomial regression residuals from the regression models
displayed in the two panels of Figure \ref{fig:scatter}.  In
particular, we calculated the residuals from Figures
\ref{fig:45degreeplot} and \ref{fig:45degreeplot_half}, Studentized
them, and then arranged resulting Studentized residuals from least to
most along the horizontal axes in Figures
\ref{fig:studentizedresiduals} and \ref{fig:studentizedresiduals_half}.

\begin{figure}[!ht]
  \centering
  \caption{Studentized residuals from Olympic finishing time regressions}
  \label{fig:residuals}
  \begin{subfigure}{.495\textwidth}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio]{studentized_residuals.pdf}
    \caption{Based on personal best} 
    \label{fig:studentizedresiduals}
  \end{subfigure}
  \begin{subfigure}{.495\textwidth}
    \centering
    \includegraphics[width=\textwidth, keepaspectratio]{studentized_residuals_half.pdf}
    \caption{Based on half marathon split}
    \label{fig:studentizedresiduals_half}
  \end{subfigure}
\end{figure}

The cumulative residuals depicted in the two panels of Figure
\ref{fig:residuals} are consistent with our interpretation of the
Hahner twin's Olympic finishing times as not particularly remarkable.
With personal best time as a measure of marathon talent as in Figure
\ref{fig:studentizedresiduals}, the two Hahner residuals are in the
right tail of the residual distribution; however, their locations are
not extreme.  One residual is located at the 88th percentile and the
other at the 93rd.  While these two residuals are in the tail end of
the residual distribution, they are not the major outliers that would
lead us to think that the Hahner twin's marathon finishing times were
extremely slow.  Moreover, the residuals for the Kim twins are
similarly not remarkable, although they are in the left tail of the
residual distribution, indicating that the Kims ran faster than one
would have expected.  If one uses half marathon split times as a
measure of marathon talent, as in Figure
\ref{fig:studentizedresiduals_half}, a similar conclusion is reached.
Neither Hahner twin had a finishing time that was particularly unusual
given her half marathon split, and this applies to the Kim twins as
well.

If the Hahner twins did not slow down excessively, might they have run
somewhat strategically at the end of the Olympic marathon in order to
generate a simultaneous finish?  We now offer a visualization that
speaks to this question.

The personal best times of the Hahner twins were 115 seconds apart and
their official finishing times were separated by one second.  Is such
a 115 to one compression typical among pairs of runners?  Moreover,
are there other pairs of Olympic marathoners who had a difference
between personal best times of 115 seconds apart and, if so, how close
were their finishing times?

Of the 133 marathon finishers, there are $\binom{133}{2} = 8,778$
pairs of runners.  Of these and ignoring the Hahner twins, ten had
exactly a 115 second gap in personal best times.  Differences in
finishing times of these ten pairs, in seconds, are as follows: 36,
93, 172, 319, 379, 459, 552, 671, 675, and 739.  In other words, of
all pairs of runners in the Rio marathon who had a personal best
difference that was equivalent to the Hahner twins' difference, the
twins had the greatest compression based on finishing time.

% df2b[abs(df2b$pb_diff)==115,]
% # A tibble: 11 × 8
%                       name_i              name_j pb_diff result_diff
%                        <chr>               <chr>   <int>       <int>
% 1                Anna Hahner         Lisa Hahner    -115          -1
% 2                  Lily Luik Mariya Korobitskaya     115          36
% 3        Lisa Jane Weightman      Lanni Marchant    -115          93
% 4           Irina Smolnikova      Viviana Chávez     115        -172
% 5              Sonia Samuels    Helalia Johannes     115        -319
% 6  Jessica Draskau-Petersson       Gladys Tejeda     115         379
% 7        Maryna Damantsevich       Gladys Tejeda     115         459
% 8          Panayióta Vlaháki     Matea Matosevic    -115         552
% 9         Nataliya Lehonkova       Olha Kotovska     115         671
% 10               Anja Scherl      Desireé Linden     115         675
% 11              Rose Chelimo    Helalia Johannes    -115        -739
% # ... with 4 more variables: diff_in_diff <int>, consecutive <lgl>,
% #   twins <chr>, PERCENTILE <dbl>
% > 

\begin{figure}[!ht]
 \caption{Pair-wise differences in Olympic finishing times and
   differences in marathon talent}
  \label{fig:diffdiff}
 \centering
 \begin{subfigure}{.49\textwidth}
 \includegraphics[width=\textwidth, keepaspectratio]{diff_in_diff_scatter_plot.pdf}
 \caption{Based on differences in personal best times}
  \label{fig:diffdiffscatter}
 \end{subfigure}
  \begin{subfigure}{.49\textwidth}
 \includegraphics[width=\textwidth, keepaspectratio]{diff_in_diff_scatter_plot_half.pdf}
 \caption{Based on differences in half marathon splits}
  \label{fig:diffdiffscatterhalf}
 \end{subfigure}
\end{figure}

We can generalize this result by looking at all pairs of runners in
the marathon.  For all 8,778 pairs of 133 finishers, Figure
\ref{fig:diffdiffscatter} plots differences in finishing times against
differences in personal best times, and pairs of twins/triplets are
identified by the same color scheme we used earlier.  Consider first
the Hahner twins.  The two German women are effectively located on the
horizontal axis because their difference in finishing times is one
second.  However, there are many points above the Hahner's orange dot,
and this shows that, conditional on an approximate 115 second
difference in personal best times, most marathoners did not have close
finishing times like the Hahners.  Some pairs of runners with around
115 second personal best differences had finishing time differences of
1,000 seconds, i.e., in excess of 15 minutes.  Of course the points in
Figure \ref{fig:diffdiffscatter} are not independent, but they provide
a sense of the dispersion in finishing time differences that one can
expect conditional on differences in personal best times.

Thinking about the accusations leveled against the Hahner twins,
Figure \ref{fig:diffdiffscatter} suggests that Anna and Lisa Hahner
did indeed run with an eye on each other.  In fact, the same can be
said of the Kim twins, who ran seemingly in lockstep throughout the
entire Rio marathon.  The North Korean twins had a personal best
difference of 53 seconds and a finishing time difference of literally
zero seconds.  Beyond these twins, there were eight pairs of Rio
runners with a 53 second personal best difference, and resulting
finishing time differences are as follows: 9, 51, 228, 340, 352, 571,
662, and 751.  As in the Hahner case, the Kim twins compressed their
finishing times---meaning that they finished with less time between
them than the difference in their personal bests---more than any other
pair of runners with similar personal best differences.

Similar conclusions follow from Figure \ref{fig:diffdiffscatterhalf},
which plots pair-wise differences between Olympic finishing times and
half marathon split times.  Namely, many pairs of runners had similar
differences in half marathon times as the Hahner and Kim twins, but
the vast majority of these pairs did not have close finishing times.

Figure \ref{fig:secondsbehind} provides a sense of the lockstep nature
of the Kim twins, and it describes each Olympic runner's status at
various split times on the marathon course.  Each dot in the figure
depicts a recorded split and the number of seconds each runner was
behind the race leader at the time.  There are more dots at earlier
splits due to subsequent DNFs.  The usual color scheme applies here,
and the Estonian triplet DNF prior to the half marathon split is
evident. As noted in the figure, Lisa Hahner was ahead of her sister
through 15 kilometers at which point Anna took the lead.  Figure
\ref{fig:secondsbehind} contains two red dots representing the North
Korean Kim twins, but this is not visually apparent because the Kim
twins had identical split times during the entire marathon.

\begin{figure}[!ht]
  \centering
  \caption{Runner status by split}
  \label{fig:secondsbehind}
  \includegraphics[scale = 1]{seconds-behind.pdf}
  % \begin{flushleft}
  %   \emph{Note: each dot represents one runner at a split.  DNFs are
  %     not pictured, and splits are not to scale.}
  % \end{flushleft}
\end{figure}

\section*{Simulating the Marathon}

% The Hahner sisters claimed that they ran the marathon independent of
% each other.  Their simultaneous finish was no more than a product of
% ability and luck.  One might expect such a finish given that their
% personal best marathons are within 114 seconds of each other.  Add a
% little bit of luck to the occasion and, as the twins have claimed all
% along, one might easily argue that the simultaneous finish is simply a
% joyous coincidence rather than a wholly implausible event.

Our visualizations are useful and shed a fair bit of light on the
Hahner twin's performance in the 2016 women's Olympic marathon.  In
the interest of increasing precision, we now pose the following
question: if we take into consideration the Hahner twin's similarities
in marathon talent as well as natural variation in marathon finishing
times, what is the probability that the twins would finish the Rio
race at roughly the same time and/or sequentially?  To answer this
question, we need to know the counterfactual distribution of potential
marathon finishing times that would have occurred had the Hahner twins
independently (in particular, of each other) and repeatedly run the
Rio marathon, holding constant marathon conditions, the abilities of
other runners, and so forth.  Access to such a distribution would
establish the set of potential outcomes that could have occurred on
August 14, 2016, and we could in principle use this distribution to
determine the likelihood that a simultaneous finish by the Hahners, or
at least a near-simultaneous finish, occurred by chance alone.  If
these twins rarely finish the marathon together in such a
counterfactual world, then one might be skeptical that their observed
finish occurred without coordination.

Unfortunately for us but nonetheless fortunately for the race's
participants, it is not possible to rerun the women's Olympic marathon
to establish a distribution of potential race outcomes for the Hahner
twins.  However, we can attempt to simulate this distribution by
estimating the distribution of every other runner's finishing time,
conditional on marathon talent, and then drawing from this
distribution in order to calculate the likelihood that, for example,
Lisa and Anna Hahner finished simultaneously.

To estimate the conditional distribution of each Rio final results, we
assume that each runner's marathon time \Yi\ is distributed normally
with a mean that is a quadratic function of marathon skill $X_i$. Here
we start by assuming that marathon skill can be measured by personal
best marathon time:
$$\Yi \mid X_i \sim N\left(\beta_0 + \beta_1\,X_{i} + \beta_2\,X^2_{i}  + e_i, \sigma\right),$$
%%
where $N\left(\cdot,\cdot\right)$ denotes a normal distribution.  We
estimate $\beta_1$, $\beta_2$, and $\sigma$ using ordinary least
squares and all finishing Rio marathoners except for the Hahner/Kim
twins and Luik triplets.  For a simulated marathon, we draw a runner's
time from an estimated distribution and condition on the runner's
personal best marathon time.  Once a race is simulated for all
runners, twins and triplets included, we record both the time between
Anne and Lisa Hahner's simulated finishes and the difference in their
simulated ranks.  We then simulate a new race---drawing a new set of
finishing times---and record the same quantities. The steps of the
simulation are as follows.
\begin{enumerate}
\item Ignoring twins and triplets, estimate with least squares a
  linear model that predicts a runner's finishing time $Y_i$ based on
  her pre-Olympic personal best time $X_i$ and her best time squared.
\item Extract the resulting coefficient vector, estimated covariance
  matrix, and estimated regression variance from this model.
\item For each simulated rate, draw intercept and slope estimates
  $\tilde{\beta}_0$, $\tilde{\beta}_1$, and $\tilde{\beta}_2$,
  respectively, from a multivariate normal distribution with mean
  equal to the previously estimated coefficient vector and covariance
  equal to the previously estimated covariance matrix.
\item Given values of $\tilde{\beta}_0$, $\tilde{\beta}_1$, and
  $\tilde{\beta}_2$, for each runner draw an error $\tilde{e}$ from a
  normal distribution with mean zero and a standard deviation equal to
  the standard deviation of the original regression model's residuals.
\item For each runner, predict her final result by combining the
  randomly generated beta coefficients and error terms,
  $\tilde{y} = \tilde{\beta}_0 + \tilde{\beta}_1\,X_i +
  \tilde{\beta}_2\,X_i^2 + \tilde{e}$.
\item Eliminate each runner from the simulated race with a probability
  equal to the observed fraction of marathoners who did not finish the
  marathon.
% \item Calculate the difference in time and difference in ranking
%   between Anna Hahner and Lisa Hahner, assuming both finished the
%   race.
\item Repeat above steps 10,000 times.
\end{enumerate}

From our simulations we can generate intervals which describe the
extent of the variability in marathon finishing times. For example, in
95\% of the simulations in which Anna Hahner completed the marathon,
her finishing time was between 9,480 seconds and 10,703 seconds. This
is consistent with Anna's observed finishing time in Rio, which was
9,932 seconds. In fact, our simulations estimate that Anna should have
finished the Rio marathon in 10,092 seconds, which is slightly more
than two and one-half minutes slower than her actual time. Lisa
Hahner's corresponding 95\% interval is 9,427 to 10,619 with an
observed finishing time of 9,933 seconds.

The bottom line here is that our simulated marathon finishes are
consistent with the Hahner twins' finishing times. And note that the
regression model underlying the simulations was estimated without the
Hahner twins (and same for the Kim twins and Luik triplets). According
to our simulations, then, neither Hahner twin ran appreciably slowly,
conditional on personal best times prior to the Rio Olympics.

% 95% simulated interval for Anna Hahner finishing time in seconds: 9480 10703 
% 95% simulated interval for Lisa Hahner finishing time in seconds: 9427 10619 

% > df$FINAL[df$ATHLETE == "Anna Hahner"]
% [1] 9932
% > df$FINAL[df$ATHLETE == "Lisa Hahner"]
% [1] 9933

With an eye on the matter of simultaneous finishing, Figure
\ref{fig:simdiff} contains two histograms based on our simulated race
results. Figure \ref{fig:simulatedfinishtimes} is a histogram which
shows the distribution of absolute differences in Hahner twin
finishing time where differences are grouped in 30 second bins; counts
for the various bins are denoted by the vertical lengths of the bars.
Figure \ref{fig:simulatedranks} is similar but depicts the
distribution of the absolute differences in Hahner twin rankings.
Differences are grouped as single units ranging from no runner between
the twins to nearly 120 runners between them.

\begin{figure}[!ht]
  \centering
  \caption{Distribution of simulated results for the Hahner twins
    based on personal best times}
  \label{fig:simdiff}
  \begin{subfigure}{.45\textwidth}
    \includegraphics[width=\textwidth,
    keepaspectratio]{simulated_time.pdf}
    \caption{Simulated differences in finishing times}
    \label{fig:simulatedfinishtimes}
  \end{subfigure}
  \begin{subfigure}{.45\textwidth}
    \includegraphics[width=\textwidth, keepaspectratio]{simulated_rank.pdf}
    \caption{Simulated differences in places}
    \label{fig:simulatedranks}
  \end{subfigure}
\end{figure}

The histograms in Figure \ref{fig:simdiff} raise questions about the
credibility of Anna and Lisa Hahner's story and in particular suggest
that a simultaneous finish in the Rio marathon would be very rare if
Anna and Lisa had run independently of each other. For example, in
fewer than 300 of the 10,000 simulated races did Anna and Lisa Hahner
finish within 30 seconds of one another. Moreover, they finished in
consecutive rank in fewer than 175 of the 10,000 simulated races.  The
close finish that was observed, where Anna and Lisa crossed the finish
line one after the other, would have been highly unlikely if the two
German twins had raced independently of each other.

Parallel with our prior analyses, we repeated our simulations but this
time used half marathon splits as the predicting variable in our
simulations. The results of this are in Figure \ref{fig:simdiffhalf}.
While this use of marathon splits reduces the variation in the
predicted outcome of each runner and therefore reduces the expected
distance between Anna and Lisa Hahner, even with half marathon split
as a measure of ability it is still quite rare for the twins to finish
simultaneously or consecutively.

\begin{figure}[!ht]
  \centering
  \caption{Distribution of simulated results for the Hahner twins
    based on half marathon splits}
  \label{fig:simdiffhalf} 
  \begin{subfigure}{.45\textwidth}
    \includegraphics[width=\textwidth,
    keepaspectratio]{simulated_time_half.pdf}
    \caption{Simulated differences in finishing times}
    \label{fig:simulatedfinishtimes_half}
  \end{subfigure}
  \begin{subfigure}{.45\textwidth}
    \includegraphics[width=\textwidth, keepaspectratio]{simulated_rank_half.pdf}
    \caption{Simulated differences in places}
    \label{fig:simulatedranks_half}
  \end{subfigure}
\end{figure}

An important point regarding our simulations is the way that we
handled DNFs. As our description above indicates, we assumed that DNF
probabilities are the same for all runners and that the likelihood of
a DNF is a not function of a runner's anticipated marathon finishing
time. The rug marks in Figure \ref{fig:45degreeplot} suggest that
runners with better personal best times may be more likely to DNF than
other runners, all things equal. We suspect that this occurs because
some better runners may expend excessive energy trying to achieve a
good result in the marathon and in so doing injure or exhaust
themselves; lesser runners, in contrast, may be content to finish
respectably. Regardless of the validity of this conjecture, Figure
\ref{fig:45degreeplot} shows that the Hahner twins are representative
of the sort of runners who DNFed in Rio. Since our simulated Hahner
statistics are conditioned on both Hahner twins finishing, it follows
that they are conservative. The fact that both women finished the
marathon was notable in and of itself, and by discounting the
possibility of a Hahner DNF we are giving the benefit of the doubt to
the Hahner twins.

\section*{Conclusion}

We have studied Anna and Lisa Hahner's near-simultaneous finish in the
2016 women's Olympic marathon in Rio. This finish elicited a
controversy insofar as the German twins were accused of deliberately
slowing down and finishing next to each other so as to generate media
attention. They denied this, not entirely surprisingly,

We have offered two perspectives on the marathon, one based on
visualizations and simple calculations and a second that draws on a
simulation. Both perspectives have the same implications, and they are
as follows. In a global sense, the Hahner twins did not slow down
appreciably during the Rio marathon. Their times were not fast, but
they were within reason for runners of the Hahners' abilities.
Locally, though, we find that the Hahner's finish was in fact
contrived. Their finish---one second between the two women---was an
extremely low probability event. Compared to their differences in
talent, the Hahner twins difference in finishing times was unusually
compressed. This is evidence that their finishing had elements of
intentionality---perhaps at the last minute but intentionality
nonetheless.

Our goal is not to speak to the question of whether the Hahner twins
should or should not have enjoyed a somewhat contrived moment of
Olympic glory. Neither was in contention for a podium finish in Rio,
and compared to the doping allegations that presently surround
endurance sports in general, what the Hahners did seems relatively
tame. Still, it might have behooved them to be a bit more open about
their end-of-race tactics, and to this end we have shown here how a
simple data analysis can shed light on claims about racing results.
Should the 2020 Summer Olympics feature twins and triplets again, we
look forward to a comparative analysis using the techniques
illustrated here.

% \section*{The probability of an unintentional simultaneous finish}

% Thomas Kurschilgen's accusations of an intentional finish stems from
% two observations. First, the Hahner twins finished slower than he
% expected given respective personal bests. Second, the twins finished
% together at the exactly same time. Kurschilgen clearly believed that
% neither of these events would have occurred had both Hahner run the
% marathon independently, absent coordination. By his logic, the German
% twins should have run faster and not have finished simultaneously.

% On the other hand, only a handful of runners completed the Rio
% marathon with times that were faster than their recorded best times.
% Thus, 18 minutes behind a personal record may not be the outlier that
% Kurschilgen claimed it to be. Moreover, there is good reason to
% suspect that an unintended simultaneous finish was more likely for the
% Hahner twin than it would be for any other set of runners. After all,
% these two women are twins with presumably similar abilities. Not only
% do they train together, but their pre-Rio best times are less than two
% minutes apart. While Anna may be slightly faster than Lisa measured by
% personal bests, we might expect the difference in their Rio result to
% be just as close as the differences in their recorded bests. And given
% random variation in finishing times, a simultaneous finish might not
% be out of the ordinary.

% Even though they seem similar, finishing at very similar times and
% finishing together are different phenomena. If, for example, both
% Hahners were of similar ability to each other and also to many other
% runners, then we might expect similar finishing times yet not
% necessarily similar placements. The latter will be a function of the
% extent to which all runners on the Rio course have similar talent
% levels.  This point is an important one and will be evident in the
% results that follow.

% To test the assertion that the Hahner twins paced themselves to finish
% at the same time and with back-to-back placements, we need to compute
% the probability that such a result would have occurred
% unintentionally. Hence we need to know the probability distribution of
% Anna and Lisa's finishing times if their runs had been independent of
% each other. The challenge, of course, is that this distribution is
% unknown.  

% \section*{Modeling}


% The Hahner twins either acted independently $I$ or coordinated their
% times $C$; these are the two possible states of the race
% $\psi = \{I, C\}$. Given that we observed Anna and Lisa's finishing
% times, $Y_A = y_A$ and $Y_L = y_L$, we want to know the probability
% that they ran independently, as they say they did. Hence, we are
% looking to determine, 

% $$P(\psi = I \mid y_A  \cap y_L )$$

% However, to determine this, we need to have some understanding of a
% likelihood function that specifies Rio finishing times. We want to
% know the likelihood of Anna's and Lisa's final times given
% independence $P(y_A \cap y_L \mid \psi = I )$. We can estimate this
% function with a few assumptions. First, we assume that under
% independence, any given runner's final time $Y_i$ is conditional on
% his/her running ability plus noise. Specifically, we assume that the
% $Y_i$ is a linear function of the runner's ability $X_i$ plus a
% normally distributed error term $e_i \sim N(0, \sigma)$. Second, we
% assume that every runner shares the same linear relationship - meaning
% the slope and intercept remain constant across runners. Third, we
% assume that the error term is drawn from a common distribution across
% runners. Hence, luck and misfortune are drawn from the same
% distribution. Therefore,

% $$Y_i \sim N(\beta_0 + X_{i}\beta_1 + e_i, \sigma)$$

% We also assume that a runner's ability $X_i$ can be measured precisely
% by her best marathon performance leading up to the Olympics. 

% %% Any measurement error must therefore be negligible.

% If Anna and Lisa intentionally slowed down as a result of coordination
% then we would likely observe $y_A > E(Y_A \mid \psi = I) $ and
% $y_L > E(Y_L\mid \psi = I )$. In other words, the final times that
% Anna and Lisa recorded in the race would be greater than we would
% expect if they had run independently.

% Moreover, if Anna and Lisa coordinated to finish simultaneously, then
% the difference between the two sisters' final times would be less that
% the expected difference had they run independently. Therefore, under a
% coordinated finish we would expect $\left|y_A - y_L\right| < E(\left|Y_A - Y_L\right| \mid \psi = I )$.

% \section*{Did Anna and Lisa intentionally slow down?}

% According to Kurschilgen, Anna and Lisa underperformed in the Rio marathon. He claimed that because their goal was to finish simultaneously rather than finish at their fastest pace, their times were slower than they otherwise would have been.  He claimed that the twins were simply trading speed for a photo-finish.

% If this were the case, the function generating Anna and Lisa's final times would deviate from the function that generated everyone else's final times.  Given everyone else would draw their times from the independent distribution  $Y_i \sim N(\beta_0 + X_{i}\beta_1 + e, \sigma)$,  Anna and Lisa would draw from a distribution of times that are slower in expectation. Hence, they would lie well-above the line that links a runner's performance in Rio to their previous best performance.    

% \begin{figure}[!ht]
%   \caption{Relationship between Personal Best and Result  -- caption?}
%   \label{fig:scatter}
%   \begin{subfigure}{.5\textwidth}
%     \centering
%     \includegraphics[width=\textwidth, keepaspectratio]{scatter_plot.pdf}
%     \caption{Rio finishing times and personal best times}
%     \label{fig:45degreeplot}
%   \end{subfigure}
%   \begin{subfigure}{.5\textwidth}
%     \centering
%     \includegraphics[width=.975\textwidth, keepaspectratio]{studentized_residuals.pdf}
%     \caption{Studentized residuals}
%     \label{fig:studentizedresiduals}
%   \end{subfigure}
% \end{figure}

% Figure \ref{fig:45degreeplot} displays the relationship between a
% runner's personal best (horizontal axis) and her final result
% (vertical axis).  The 133 finishers are plotted as grey points, and
% the 23 DNFs are depicted below along the horizontal axis with
% tick-marks.  The dashed black line with grey confidence intervals
% represent ordinarily least squares estimates of the linear
% relationship between racer's finishing and personal best times.

% One can see in Figure \ref{fig:scatter} that there is a clear
% relationship between a runner's personal best time and her performance
% in the Olympics.  While there is a significant amount of noise in the
% relationship, the Hahner twins' dots are well above the regression's
% fitted line notwithstanding this point.  They finished the Rio
% marathon much slower than they should have, per their pre-Olympic
% personal best times.  In fact, if we sort studentized residual, we can
% see in Figure \ref{fig:studentizedresiduals} that the Hahner twins are
% in the tail-end of the residual distribution.  Anna Hahner's residual
% deviation is greater than 91.7\% of the runners who completed the
% marathon while Lisa Hahner's deviation is greater than 86.5\%.  Hence,
% the twins appear to have finished at a much slower pace than expected,
% which is what we might expect if they were coordinating their runs.
% The North Korean Kim twins are also in the tail of the residual
% distribution---but the left tail.  These twins finished much faster
% than expected. 

% \section*{Did Anna and Lisa intentionally finish together?}

% Anna and Lisa finished the marathon at an unusually slow rate, which is what we might expect if the twins intentionally slowed their pace to finish simultaneously.  However, the observation of a slow finish does not necessarily imply that it was an intentional result .  It only suggests that Kurschilgen's claim regarding this issue holds up in the data.

% Perhaps it would be easier to refute the claim if we could show that the Twins's back-to-back finish was not such an unusual event.  Given that Anna and Lisa were so close in their personal best times, it may seem reasonable to expect that they would also be close in their finishing times.   Hence, one way to determine if the twins's finish was intentional is to quantify the likelihood that such a close finish would occur by chance given the differences in their ability. 

% We can attempt to quantify this likelihood by looking at how differences in the personal best time of two runners translate into differences in Olympic times .  If Anna and Lisa's finish was unintentional we'd expect that such a close finish would be unlikely given their difference in personal best times.   Yet, how does the difference in personal best times relate to the difference in finishing times?

% One way we can estimate this relationship is to look at all of the differences that we observe in the marathon.  We can take the difference in personal best time for every combination of runners in the data and look at the difference in their final times.  We should expect that compared to the difference in their personal best times, the difference in Anna and Lisa's final times should be commensurate with the conditional difference of all other runners. %This needs a better explanation.

% Therefore, we find all combinations of runners in the marathon and calculate two quantities: 1) the difference in their personal best time and 2) the difference in their final time. We plot the relationship between the two quantities in Figure \ref{fig:diffdiffscatter}.   All 8,778 dyadic combinations of runners are displayed by grey points in the scatter plot.   The solid black line indicates a one-to-one relationship, where every point would fall if the difference in final times were systematically equivalent to the difference in personal bests.  


% % \begin{figure}[!ht]
% %  \caption{Relationship between Difference in Personal Best and Difference in Result}
% %  \label{fig:diffdiffscatter}
% %  \centering
% %  \begin{subfigure}{.5\textwidth}
% %  \includegraphics[width=\textwidth, keepaspectratio]{diff_in_diff_scatter_plot.pdf}
% %  \end{subfigure}
% % \end{figure}

% We can see from the yellow dot that the Hahner Twins are just below this one-to-one line.  Hence, the twins' final times were closer to each other than their personal best times; but not by much.  In fact, this might be an expected difference if we expected there to be a one-to-one relationship.     However, although there is a clear relationship between the difference in final time and the difference in personal best, it is not a strong one-to-one relationship.  We've added a dotted smoother to display a cubic splines estimate of the conditional averages.  While the Hahner twins may be close to the one-to-one line, they are much further away from the average set of runners.  Hence, we would expect for any pair of runners, the difference in their final results should be much greater than their difference in their personal best.  However, the Hahner twins do not fit this expectation.   Yet, how different from this expectation are they?

% One way we can quantify the degree to which the twins are outliers is by comparing their difference in difference to every other pair of runner's difference-in-differences.  We calculate the difference-in-differences for each pair of runners by simply subtracting their difference in result (y-axis) from their difference in personal best (x-axis).  Therefore positive difference-in-differences mean that the runners ended up further apart than their difference in personal bests.  Negative difference-in-differences mean that the runners end up closer together.  Hence, the Hahner twins have a difference-in-difference of -114 seconds.  They finished 114 seconds closer together than the distance between their personal bests.  

% We arrange all 8,778 difference-in-differences from small to large in the first plot in Figure \ref{fig:diffdiff}. The Hahner twins are denoted by the yellow point.  Using this plot we can visualize where the twins fall within the distribution of difference-in-differences.  It is clear that they are closer to the lower tail of the distribution.  However, compared to all other difference-in-differences, their result is not that extreme.  Nearly 21\% of the difference-in-dfferences were less than the that of the twins'. Hence, we'd expect at least one in five pairs of runners to have a reduction in difference at least as great as the twins.

% However, if we limit the observations to only those runners who had personal best times that were at least as close to each other as the Hahner twins, we get a different perspective.  Among those runners,  the Hahner twins reduced the distance between them to the greatest extent.  There was no other pair of runners whose reduced the difference in the final time relative to their difference in personal bests more than them.         

% \begin{figure}[!ht]
%  \caption{How Hahner Twins Rank in Difference-in-Differences}
%  \label{fig:diffdiff}
%  \begin{subfigure}{.5\textwidth}
%  \includegraphics[width=\textwidth, keepaspectratio]{diff_in_diff_1.pdf}
%  \end{subfigure}
%  \begin{subfigure}{.5\textwidth}
%  \includegraphics[width=\textwidth, keepaspectratio]{diff_in_diff_2.pdf}
%  \end{subfigure}
% \end{figure}











\section*{Further reading}

\begin{itemize}

\item \url{http://www.telegraph.co.uk/olympics/2016/08/17/german-twins-criticised-for-finishing-olympic-marathon-fun-run-h}

\item
  \url{https://www.nytimes.com/2016/08/17/sports/olympics/twins-finish-marathon-hand-in-hand-but-their-country-says-they-crossed-a-line.html}

\item
  \url{https://www.welt.de/sport/olympia/article157669264/Das-falsche-Laecheln-der-deutschen-Lauf-Zwillinge.html}
\end{itemize}

\end{document}

